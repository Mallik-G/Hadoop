CREATE TABLE STOCK_TRANS_TABLE (
STOCK_EXCHANGE VARCHAR(5),
STOCK_SYMBOL VARCHAR(5),
STOCK_TRANS_DATE VARCHAR(10),
STOCK_OPEN_PRICE DECIMAL(4,2),
STOCK_HIGH_PRICE DECIMAL(4,2),
STOCK_LOW_PRICE DECIMAL(4,2),
STOCK_CLOSE_PRICE DECIMAL(4,2),
STOCK_VOLUME VARCHAR(15),
STOCK_AVG_PRICE DECIMAL(4,2))



CREATE TABLE STOCK_NAME(STOCK_SYMBOL VARCHAR(5) NOT NULL,STOCK_NAME VARCHAR(45), PRIMARY KEY(STOCK_SYMBOL));

ALTER TABLE STOCK_TRANS_TABLE 
ADD FOREIGN KEY(STOCK_SYMBOL) 
REFERENCES STOCK_NAME(STOCK_SYMBOL);


LOAD DATA LOCAL INFILE '/home/bhuvan/pig/pigdata/NYSE_daily'
INTO TABLE TEMP_TABLE;
FIELDS TERMINATED BT '\t';

INSERT INTO STOCK_NAME(SELECT DISTINCT(STOCK_SYMBOL),NULL FROM TEMP_TABLE);

LOAD DATA LOCAL INFILE '/home/bhuvan/pig/pigdata/NYSE_dividends' INTO TABLE STOCK_DIVIDEND_TABLE;


CREATE TABLE STOCK_DIVIDEND_TABLE (
STOCK_EXCHANGE VARCHAR(5),
STOCK_SYMBOL VARCHAR(4),
STOCK_DIV_DATE VARCHAR(10),
DIVIDEND_GIVEN DECIMAL(4,4);


ALTER TABLE STOCK_DIVIDEND_TABLE 
ADD FOREIGN KEY(STOCK_SYMBOL) 
REFERENCES STOCK_NAME(STOCK_SYMBOL);







